{% extends "base.html" %}
{% block title %}Estatísticas · Flow Forecaster{% endblock %}
{% block page_title %}Estatísticas & Insights{% endblock %}
{% block page_subtitle %}Analise distribuição de throughput, lead time e resultados da última simulação.{% endblock %}
{% block header_actions %}
<a href="{{ url_for('simulation') }}" class="btn btn-outline-modern"><i class="fas fa-arrow-left mr-2"></i>Voltar para simulação</a>
{% endblock %}
{% block content %}
<div id="stats-empty" class="card-modern text-center">
    <h4>Execute uma simulação para ver as estatísticas</h4>
    <p class="text-muted mb-4">Ainda não identificamos resultados recentes. Rode a simulação Monte Carlo para ativar este painel.</p>
    <a href="{{ url_for('simulation') }}" class="btn btn-primary-modern"><i class="fas fa-play mr-2"></i>Executar agora</a>
</div>

<div id="stats-content" class="d-none">
    <div class="metric-grid mb-4">
        <div class="metric-card">
            <div class="metric-label">Backlog analisado</div>
            <div class="metric-value" id="stat-backlog">-</div>
        </div>
        <div class="metric-card">
            <div class="metric-label">Equipe total</div>
            <div class="metric-value" id="stat-team">-</div>
        </div>
        <div class="metric-card">
            <div class="metric-label">P85 de duração</div>
            <div class="metric-value" id="stat-duration">-</div>
        </div>
        <div class="metric-card">
            <div class="metric-label">Esforço estimado</div>
            <div class="metric-value" id="stat-effort">-</div>
        </div>
    </div>

    <div class="card-modern">
        <h4 class="mb-3">Throughput semanal</h4>
        <div class="charts-grid mb-3">
            <div class="chart-container">
                <canvas id="throughputHistogram"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="throughputControl"></canvas>
            </div>
        </div>
        <div class="table-responsive table-modern">
            <table class="table table-sm" id="throughputStatsTable">
                <thead>
                    <tr class="text-uppercase text-muted">
                        <th>Métrica</th>
                        <th>Valor</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div class="card-modern">
        <h4 class="mb-3">Lead time das tarefas</h4>
        <div class="charts-grid mb-3">
            <div class="chart-container">
                <canvas id="leadHistogram"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="leadControl"></canvas>
            </div>
        </div>
        <div class="table-responsive table-modern">
            <table class="table table-sm" id="leadStatsTable">
                <thead>
                    <tr class="text-uppercase text-muted">
                        <th>Métrica</th>
                        <th>Valor</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <div class="card-modern">
        <h4 class="mb-3">Distribuição das simulações</h4>
        <div class="charts-grid">
            <div class="chart-container">
                <canvas id="durationHistogram"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="tasksHistogram"></canvas>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/statistics.js') }}?v=20241201"></script>
{% endblock %}
